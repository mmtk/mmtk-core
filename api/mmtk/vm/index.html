<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="MMTk-to-VM interface: the VMBinding trait."><title>mmtk::vm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0 (aedd173a2 2024-03-17)" data-channel="1.77.0" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-4c98445ec4002617.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../mmtk/index.html">mmtk</a><span class="version">0.29.0-3c1418abf5e23f190d2b73f85a0f23f9f961721d</span></h2></div><h2 class="location"><a href="#">Module vm</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li></ul></section><h2><a href="../index.html">In crate mmtk</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../mmtk/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press â€˜Sâ€™ to search, â€˜?â€™ for more optionsâ€¦" type="search"><div id="help-button" tabindex="-1"><a href="../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">mmtk</a>::<wbr><a class="mod" href="#">vm</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/mmtk/vm/mod.rs.html#1-82">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>MMTk-to-VM interface: the VMBinding trait.</p>
<p>This module provides VM-specific traits that serve as MMTK-to-VM interfaces.
Each VM binding needs to provide an implementation for each of the traits.
MMTk requires the interfaces to be efficient, as some of the methods are called frequently
during collection (e.g. the methods for <code>ObjectModel</code>). We rely on cross-crate <em>link-time-optimization</em>
to remove the overhead of MMTk invoking methods on those traits.</p>
<p>It is recommended for a VM binding that uses mmtk-core to do the following to ensure LTO is enabled for performance.</p>
<ol>
<li>Add the following section in the manifest file of a VM binding (<code>Cargo.toml</code>). This enables LTO for the release build:
<div class="example-wrap"><pre class="rust rust-example-rendered"><code>[profile.release]
lto = <span class="bool-val">true</span></code></pre></div>
</li>
<li>Make sure that the crate type for a VM binding supports LTO. To our knowledge, <code>staticlib</code> and <code>cdylib</code> support LTO, and
<code>rlib</code> does <em>not</em> support LTO.</li>
</ol>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="active_plan/index.html" title="mod mmtk::vm::active_plan">active_plan</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="collection/index.html" title="mod mmtk::vm::collection">collection</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="object_model/index.html" title="mod mmtk::vm::object_model">object_model</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="reference_glue/index.html" title="mod mmtk::vm::reference_glue">reference_glue</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="scanning/index.html" title="mod mmtk::vm::scanning">scanning</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="slot/index.html" title="mod mmtk::vm::slot">slot</a></div><div class="desc docblock-short">This module provides the trait <a href="slot/trait.Slot.html" title="trait mmtk::vm::slot::Slot"><code>Slot</code></a> and related traits and types which allow VMs to
customize the layout of slots and the behavior of loading and updating object references in
slots.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.VMGlobalLogBitSpec.html" title="struct mmtk::vm::VMGlobalLogBitSpec">VMGlobalLogBitSpec</a></div><div class="desc docblock-short">1-bit global metadata to log an object.</div></li><li><div class="item-name"><a class="struct" href="struct.VMLocalForwardingBitsSpec.html" title="struct mmtk::vm::VMLocalForwardingBitsSpec">VMLocalForwardingBitsSpec</a></div><div class="desc docblock-short">2-bit local metadata for spaces that store a forwarding state for objects.
If this spec is defined in the header, it can be defined with a position of the lowest 2 bits in the forwarding pointer.</div></li><li><div class="item-name"><a class="struct" href="struct.VMLocalForwardingPointerSpec.html" title="struct mmtk::vm::VMLocalForwardingPointerSpec">VMLocalForwardingPointerSpec</a></div><div class="desc docblock-short">1-word local metadata for spaces that may copy objects.
This metadata has to be stored in the header.
This metadata can be defined at a position within the object payload.
As a forwarding pointer is only stored in dead objects which is not
accessible by the language, it is okay that store a forwarding pointer overwrites object payload</div></li><li><div class="item-name"><a class="struct" href="struct.VMLocalLOSMarkNurserySpec.html" title="struct mmtk::vm::VMLocalLOSMarkNurserySpec">VMLocalLOSMarkNurserySpec</a></div><div class="desc docblock-short">2-bits local metadata for the large object space. The two bits serve as
the mark bit and the nursery bit.</div></li><li><div class="item-name"><a class="struct" href="struct.VMLocalMarkBitSpec.html" title="struct mmtk::vm::VMLocalMarkBitSpec">VMLocalMarkBitSpec</a></div><div class="desc docblock-short">1-bit local metadata for spaces that need to mark an object.</div></li><li><div class="item-name"><a class="struct" href="struct.VMLocalPinningBitSpec.html" title="struct mmtk::vm::VMLocalPinningBitSpec">VMLocalPinningBitSpec</a></div><div class="desc docblock-short">1-bit local metadata for spaces that support pinning.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.GCThreadContext.html" title="enum mmtk::vm::GCThreadContext">GCThreadContext</a></div><div class="desc docblock-short">Thread context for the spawned GC thread.  It is used by <code>spawn_gc_thread</code>.
Currently, <code>GCWorker</code> is the only kind of thread that mmtk-core will create.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.DEFAULT_LOG_MAX_ALIGNMENT.html" title="constant mmtk::vm::DEFAULT_LOG_MAX_ALIGNMENT">DEFAULT_LOG_MAX_ALIGNMENT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Default max alignment 8 bytes</div></li><li><div class="item-name"><a class="constant" href="constant.DEFAULT_LOG_MIN_ALIGNMENT.html" title="constant mmtk::vm::DEFAULT_LOG_MIN_ALIGNMENT">DEFAULT_LOG_MIN_ALIGNMENT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Default min alignment 4 bytes</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.ActivePlan.html" title="trait mmtk::vm::ActivePlan">ActivePlan</a></div><div class="desc docblock-short">VM-specific methods for the current plan.</div></li><li><div class="item-name"><a class="trait" href="trait.Collection.html" title="trait mmtk::vm::Collection">Collection</a></div><div class="desc docblock-short">VM-specific methods for garbage collection.</div></li><li><div class="item-name"><a class="trait" href="trait.Finalizable.html" title="trait mmtk::vm::Finalizable">Finalizable</a></div><div class="desc docblock-short">A finalizable object for MMTk. MMTk needs to know the actual object reference in the type,
while a binding can use this type to store some runtime information about finalizable objects.
For example, for bindings that allows multiple finalizer methods with one object, they can define
the type as a tuple of <code>(object, finalize method)</code>, and register different finalizer methods to MMTk
for the same object.
The implementation should mark theird method implementations as inline for performance.</div></li><li><div class="item-name"><a class="trait" href="trait.ObjectModel.html" title="trait mmtk::vm::ObjectModel">ObjectModel</a></div><div class="desc docblock-short">VM-specific methods for object model.</div></li><li><div class="item-name"><a class="trait" href="trait.ObjectTracer.html" title="trait mmtk::vm::ObjectTracer">ObjectTracer</a></div><div class="desc docblock-short">Callback trait of scanning functions that directly trace through object graph edges.</div></li><li><div class="item-name"><a class="trait" href="trait.ObjectTracerContext.html" title="trait mmtk::vm::ObjectTracerContext">ObjectTracerContext</a></div><div class="desc docblock-short">An <code>ObjectTracerContext</code> gives a GC worker temporary access to an <code>ObjectTracer</code>, allowing
the GC worker to trace objects.  This trait is intended to abstract out the implementation
details of tracing objects, enqueuing objects, and creating work packets that expand the
transitive closure, allowing the VM binding to focus on VM-specific parts.</div></li><li><div class="item-name"><a class="trait" href="trait.ReferenceGlue.html" title="trait mmtk::vm::ReferenceGlue">ReferenceGlue</a></div><div class="desc docblock-short">VM-specific methods for reference processing, including weak references, and finalizers.
We handle weak references and finalizers differently:</div></li><li><div class="item-name"><a class="trait" href="trait.RootsWorkFactory.html" title="trait mmtk::vm::RootsWorkFactory">RootsWorkFactory</a></div><div class="desc docblock-short">Root-scanning methods use this trait to create work packets for processing roots.</div></li><li><div class="item-name"><a class="trait" href="trait.Scanning.html" title="trait mmtk::vm::Scanning">Scanning</a></div><div class="desc docblock-short">VM-specific methods for scanning roots/objects.</div></li><li><div class="item-name"><a class="trait" href="trait.SlotVisitor.html" title="trait mmtk::vm::SlotVisitor">SlotVisitor</a></div><div class="desc docblock-short">Callback trait of scanning functions that report slots.</div></li><li><div class="item-name"><a class="trait" href="trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a></div><div class="desc docblock-short">The <code>VMBinding</code> trait associates with each trait, and provides VM-specific constants.</div></li></ul></section></div></main></body></html>
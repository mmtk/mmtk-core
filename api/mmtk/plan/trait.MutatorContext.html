<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Each GC plan should provide their implementation of a MutatorContext. Note that this trait is no longer needed as we removed per-plan mutator implementation and we will remove this trait as well in the future."><title>MutatorContext in mmtk::plan - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0 (aedd173a2 2024-03-17)" data-channel="1.77.0" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-4c98445ec4002617.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../mmtk/index.html">mmtk</a><span class="version">0.28.0-328deb6bfb920e895594f374e83daad57b639a7f</span></h2></div><h2 class="location"><a href="#">MutatorContext</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.alloc">alloc</a></li><li><a href="#tymethod.alloc_slow">alloc_slow</a></li><li><a href="#tymethod.barrier">barrier</a></li><li><a href="#tymethod.get_tls">get_tls</a></li><li><a href="#tymethod.post_alloc">post_alloc</a></li><li><a href="#tymethod.prepare">prepare</a></li><li><a href="#tymethod.release">release</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.flush">flush</a></li><li><a href="#method.flush_remembered_sets">flush_remembered_sets</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In mmtk::plan</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../mmtk/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">mmtk</a>::<wbr><a href="index.html">plan</a>::<wbr><a class="trait" href="#">MutatorContext</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/mmtk/plan/mutator_context.rs.html#262-312">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait MutatorContext&lt;VM: <a class="trait" href="../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt;: <a class="trait" href="https://doc.rust-lang.org/1.77.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'static {
    // Required methods
    fn <a href="#tymethod.prepare" class="fn">prepare</a>(&amp;mut self, tls: <a class="struct" href="../util/opaque_pointer/struct.VMWorkerThread.html" title="struct mmtk::util::opaque_pointer::VMWorkerThread">VMWorkerThread</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.release" class="fn">release</a>(&amp;mut self, tls: <a class="struct" href="../util/opaque_pointer/struct.VMWorkerThread.html" title="struct mmtk::util::opaque_pointer::VMWorkerThread">VMWorkerThread</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.alloc" class="fn">alloc</a>(
        &amp;mut self,
        size: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        align: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        offset: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
    ) -&gt; <a class="struct" href="../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.alloc_slow" class="fn">alloc_slow</a>(
        &amp;mut self,
        size: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        align: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        offset: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
    ) -&gt; <a class="struct" href="../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.post_alloc" class="fn">post_alloc</a>(
        &amp;mut self,
        refer: <a class="struct" href="../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>,
        bytes: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
        allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
    );
<span class="item-spacer"></span>    fn <a href="#tymethod.get_tls" class="fn">get_tls</a>(&amp;self) -&gt; <a class="struct" href="../util/opaque_pointer/struct.VMMutatorThread.html" title="struct mmtk::util::opaque_pointer::VMMutatorThread">VMMutatorThread</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.barrier" class="fn">barrier</a>(&amp;mut self) -&gt; &amp;mut dyn <a class="trait" href="barriers/trait.Barrier.html" title="trait mmtk::plan::barriers::Barrier">Barrier</a>&lt;VM&gt;;

    // Provided methods
    fn <a href="#method.flush_remembered_sets" class="fn">flush_remembered_sets</a>(&amp;mut self) { ... }
<span class="item-spacer"></span>    fn <a href="#method.flush" class="fn">flush</a>(&amp;mut self) { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Each GC plan should provide their implementation of a MutatorContext. <em>Note that this trait is no longer needed as we removed
per-plan mutator implementation and we will remove this trait as well in the future.</em></p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.prepare" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#264">source</a><h4 class="code-header">fn <a href="#tymethod.prepare" class="fn">prepare</a>(&amp;mut self, tls: <a class="struct" href="../util/opaque_pointer/struct.VMWorkerThread.html" title="struct mmtk::util::opaque_pointer::VMWorkerThread">VMWorkerThread</a>)</h4></section></summary><div class="docblock"><p>Do the prepare work for this mutator.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.release" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#266">source</a><h4 class="code-header">fn <a href="#tymethod.release" class="fn">release</a>(&amp;mut self, tls: <a class="struct" href="../util/opaque_pointer/struct.VMWorkerThread.html" title="struct mmtk::util::opaque_pointer::VMWorkerThread">VMWorkerThread</a>)</h4></section></summary><div class="docblock"><p>Do the release work for this mutator.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.alloc" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#274-280">source</a><h4 class="code-header">fn <a href="#tymethod.alloc" class="fn">alloc</a>(
    &amp;mut self,
    size: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    align: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    offset: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
) -&gt; <a class="struct" href="../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a></h4></section></summary><div class="docblock"><p>Allocate memory for an object.</p>
<p>Arguments:</p>
<ul>
<li><code>size</code>: the number of bytes required for the object.</li>
<li><code>align</code>: required alignment for the object.</li>
<li><code>offset</code>: offset associated with the alignment. The result plus the offset will be aligned to the given alignment.</li>
<li><code>allocator</code>: the allocation semantic used for this object.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.alloc_slow" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#284-290">source</a><h4 class="code-header">fn <a href="#tymethod.alloc_slow" class="fn">alloc_slow</a>(
    &amp;mut self,
    size: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    align: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    offset: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
) -&gt; <a class="struct" href="../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a></h4></section></summary><div class="docblock"><p>The slow path allocation. This is only useful when the binding
implements the fast path allocation, and would like to explicitly
call the slow path after the fast path allocation fails.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.post_alloc" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#298">source</a><h4 class="code-header">fn <a href="#tymethod.post_alloc" class="fn">post_alloc</a>(
    &amp;mut self,
    refer: <a class="struct" href="../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>,
    bytes: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>,
    allocator: <a class="enum" href="global/enum.AllocationSemantics.html" title="enum mmtk::plan::global::AllocationSemantics">AllocationSemantics</a>
)</h4></section></summary><div class="docblock"><p>Perform post-allocation actions.  For many allocators none are
required.</p>
<p>Arguments:</p>
<ul>
<li><code>refer</code>: the newly allocated object.</li>
<li><code>bytes</code>: the size of the space allocated (in bytes).</li>
<li><code>allocator</code>: the allocation semantic used.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.get_tls" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#309">source</a><h4 class="code-header">fn <a href="#tymethod.get_tls" class="fn">get_tls</a>(&amp;self) -&gt; <a class="struct" href="../util/opaque_pointer/struct.VMMutatorThread.html" title="struct mmtk::util::opaque_pointer::VMMutatorThread">VMMutatorThread</a></h4></section></summary><div class="docblock"><p>Get the mutator thread for this mutator context. This is the same value as the argument supplied in
<a href="../memory_manager/fn.bind_mutator.html" title="fn mmtk::memory_manager::bind_mutator"><code>crate::memory_manager::bind_mutator</code></a> when this mutator is created.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.barrier" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#311">source</a><h4 class="code-header">fn <a href="#tymethod.barrier" class="fn">barrier</a>(&amp;mut self) -&gt; &amp;mut dyn <a class="trait" href="barriers/trait.Barrier.html" title="trait mmtk::plan::barriers::Barrier">Barrier</a>&lt;VM&gt;</h4></section></summary><div class="docblock"><p>Get active barrier trait object</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.flush_remembered_sets" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#300-302">source</a><h4 class="code-header">fn <a href="#method.flush_remembered_sets" class="fn">flush_remembered_sets</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>Flush per-mutator remembered sets and create GC work for the remembered sets.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.flush" class="method"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#304-306">source</a><h4 class="code-header">fn <a href="#method.flush" class="fn">flush</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>Flush the mutator context.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-MutatorContext%3CVM%3E-for-Mutator%3CVM%3E" class="impl"><a class="src rightside" href="../../src/mmtk/plan/mutator_context.rs.html#100-159">source</a><a href="#impl-MutatorContext%3CVM%3E-for-Mutator%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="mutator_context/trait.MutatorContext.html" title="trait mmtk::plan::mutator_context::MutatorContext">MutatorContext</a>&lt;VM&gt; for <a class="struct" href="mutator_context/struct.Mutator.html" title="struct mmtk::plan::mutator_context::Mutator">Mutator</a>&lt;VM&gt;</h3></section></div><script src="../../trait.impl/mmtk/plan/mutator_context/trait.MutatorContext.js" async></script></section></div></main></body></html>
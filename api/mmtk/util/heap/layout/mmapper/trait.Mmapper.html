<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generic mmap and protection functionality"><title>Mmapper in mmtk::util::heap::layout::mmapper - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../../../../" data-static-root-path="../../../../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../../mmtk/index.html">mmtk</a><span class="version">0.30.0-129362d4f39a1191562d276c42f5b03e52aa287a</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Mmapper</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.eagerly_mmap_all_spaces" title="eagerly_mmap_all_spaces">eagerly_mmap_all_spaces</a></li><li><a href="#tymethod.ensure_mapped" title="ensure_mapped">ensure_mapped</a></li><li><a href="#tymethod.is_mapped_address" title="is_mapped_address">is_mapped_address</a></li><li><a href="#tymethod.mark_as_mapped" title="mark_as_mapped">mark_as_mapped</a></li><li><a href="#tymethod.protect" title="protect">protect</a></li><li><a href="#tymethod.quarantine_address_range" title="quarantine_address_range">quarantine_address_range</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In mmtk::<wbr>util::<wbr>heap::<wbr>layout::<wbr>mmapper</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../../../index.html">mmtk</a>::<wbr><a href="../../../index.html">util</a>::<wbr><a href="../../index.html">heap</a>::<wbr><a href="../index.html">layout</a>::<wbr><a href="index.html">mmapper</a></span><h1>Trait <span class="trait">Mmapper</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#10-79">source</a> </span></div><pre class="rust item-decl"><code>pub trait Mmapper: <a class="trait" href="https://doc.rust-lang.org/1.83.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> {
    // Required methods
    fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fn">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>]);
<span class="item-spacer"></span>    fn <a href="#tymethod.mark_as_mapped" class="fn">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.quarantine_address_range" class="fn">quarantine_address_range</a>(
        &amp;self,
        start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>,
        pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
        strategy: <a class="struct" href="../../../memory/struct.MmapStrategy.html" title="struct mmtk::util::memory::MmapStrategy">MmapStrategy</a>,
        anno: &amp;<a class="enum" href="../../../memory/enum.MmapAnnotation.html" title="enum mmtk::util::memory::MmapAnnotation">MmapAnnotation</a>&lt;'_&gt;,
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.83.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.ensure_mapped" class="fn">ensure_mapped</a>(
        &amp;self,
        start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>,
        pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
        strategy: <a class="struct" href="../../../memory/struct.MmapStrategy.html" title="struct mmtk::util::memory::MmapStrategy">MmapStrategy</a>,
        anno: &amp;<a class="enum" href="../../../memory/enum.MmapAnnotation.html" title="enum mmtk::util::memory::MmapAnnotation">MmapAnnotation</a>&lt;'_&gt;,
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.83.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_mapped_address" class="fn">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.protect" class="fn">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generic mmap and protection functionality</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">ยง</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.eagerly_mmap_all_spaces" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#17">source</a><h4 class="code-header">fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fn">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>])</h4></section></summary><div class="docblock"><p>Given an address array describing the regions of virtual memory to be used
by MMTk, demand zero map all of them if they are not already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>spaceMap</code>: An address array containing a pairs of start and end
addresses for each of the regions to be mapped</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.mark_as_mapped" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#26">source</a><h4 class="code-header">fn <a href="#tymethod.mark_as_mapped" class="fn">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as mapped, without making any
request to the operating system.  Used to mark pages
that the VM has already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be mapped</li>
<li><code>bytes</code>: Number of bytes to ensure mapped</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.quarantine_address_range" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#38-44">source</a><h4 class="code-header">fn <a href="#tymethod.quarantine_address_range" class="fn">quarantine_address_range</a>(
    &amp;self,
    start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>,
    pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
    strategy: <a class="struct" href="../../../memory/struct.MmapStrategy.html" title="struct mmtk::util::memory::MmapStrategy">MmapStrategy</a>,
    anno: &amp;<a class="enum" href="../../../memory/enum.MmapAnnotation.html" title="enum mmtk::util::memory::MmapAnnotation">MmapAnnotation</a>&lt;'_&gt;,
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.83.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Quarantine/reserve address range. We mmap from the OS with no reserve and with PROT_NONE,
which should be little overhead. This ensures that we can reserve certain address range that
we can use if needed. Quarantined memory needs to be mapped before it can be used.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be quarantined</li>
<li><code>bytes</code>: Number of bytes to quarantine from the start</li>
<li><code>strategy</code>: The mmap strategy.  The <code>prot</code> field is ignored because we always use
<code>PROT_NONE</code>.</li>
<li><code>anno</code>: Human-readable annotation to apply to newly mapped memory ranges.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.ensure_mapped" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#58-64">source</a><h4 class="code-header">fn <a href="#tymethod.ensure_mapped" class="fn">ensure_mapped</a>(
    &amp;self,
    start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>,
    pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
    strategy: <a class="struct" href="../../../memory/struct.MmapStrategy.html" title="struct mmtk::util::memory::MmapStrategy">MmapStrategy</a>,
    anno: &amp;<a class="enum" href="../../../memory/enum.MmapAnnotation.html" title="enum mmtk::util::memory::MmapAnnotation">MmapAnnotation</a>&lt;'_&gt;,
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.83.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Ensure that a range of pages is mmapped (or equivalent).  If the
pages are not yet mapped, demand-zero map them. Note that mapping
occurs at chunk granularity, not page granularity.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: The start of the range to be mapped.</li>
<li><code>pages</code>: The size of the range to be mapped, in pages</li>
<li><code>strategy</code>: The mmap strategy.</li>
<li><code>anno</code>: Human-readable annotation to apply to newly mapped memory ranges.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.is_mapped_address" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#71">source</a><h4 class="code-header">fn <a href="#tymethod.is_mapped_address" class="fn">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Is the page pointed to by this address mapped? Returns true if
the page at the given address is mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>addr</code>: Address in question</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.protect" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#78">source</a><h4 class="code-header">fn <a href="#tymethod.protect" class="fn">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as inaccessible.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be protected</li>
<li><code>pages</code>: Number of pages to be protected</li>
</ul>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">ยง</a></h2><div id="implementors-list"><section id="impl-Mmapper-for-ByteMapMmapper" class="impl"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/byte_map_mmapper.rs.html#35-132">source</a><a href="#impl-Mmapper-for-ByteMapMmapper" class="anchor">ยง</a><h3 class="code-header">impl <a class="trait" href="trait.Mmapper.html" title="trait mmtk::util::heap::layout::mmapper::Mmapper">Mmapper</a> for <a class="struct" href="../byte_map_mmapper/struct.ByteMapMmapper.html" title="struct mmtk::util::heap::layout::byte_map_mmapper::ByteMapMmapper">ByteMapMmapper</a></h3></section><section id="impl-Mmapper-for-FragmentedMapper" class="impl"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/fragmented_mapper.rs.html#68-231">source</a><a href="#impl-Mmapper-for-FragmentedMapper" class="anchor">ยง</a><h3 class="code-header">impl <a class="trait" href="trait.Mmapper.html" title="trait mmtk::util::heap::layout::mmapper::Mmapper">Mmapper</a> for <a class="struct" href="../fragmented_mapper/struct.FragmentedMapper.html" title="struct mmtk::util::heap::layout::fragmented_mapper::FragmentedMapper">FragmentedMapper</a></h3></section></div><script src="../../../../../trait.impl/mmtk/util/heap/layout/mmapper/trait.Mmapper.js" async></script></section></div></main></body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generic mmap and protection functionality"><title>Mmapper in mmtk::util::heap::layout::mmapper - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../../../../../" data-static-root-path="../../../../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0 (aedd173a2 2024-03-17)" data-channel="1.77.0" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../../../static.files/storage-4c98445ec4002617.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../../../../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../../mmtk/index.html">mmtk</a><span class="version">0.25.0-170630fc84bc82070ca6e06ea4fed76894aa703f</span></h2></div><h2 class="location"><a href="#">Mmapper</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.eagerly_mmap_all_spaces">eagerly_mmap_all_spaces</a></li><li><a href="#tymethod.ensure_mapped">ensure_mapped</a></li><li><a href="#tymethod.is_mapped_address">is_mapped_address</a></li><li><a href="#tymethod.mark_as_mapped">mark_as_mapped</a></li><li><a href="#tymethod.protect">protect</a></li><li><a href="#tymethod.quarantine_address_range">quarantine_address_range</a></li><li><a href="#tymethod.set_mmap_strategy">set_mmap_strategy</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In mmtk::util::heap::layout::mmapper</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../../../../mmtk/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../../../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../../../../index.html">mmtk</a>::<wbr><a href="../../../index.html">util</a>::<wbr><a href="../../index.html">heap</a>::<wbr><a href="../index.html">layout</a>::<wbr><a href="index.html">mmapper</a>::<wbr><a class="trait" href="#">Mmapper</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#10-65">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Mmapper: <a class="trait" href="https://doc.rust-lang.org/1.77.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> {
    // Required methods
    fn <a href="#tymethod.set_mmap_strategy" class="fn">set_mmap_strategy</a>(&amp;self, strategy: <a class="enum" href="../../../memory/enum.MmapStrategy.html" title="enum mmtk::util::memory::MmapStrategy">MmapStrategy</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fn">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>]);
<span class="item-spacer"></span>    fn <a href="#tymethod.mark_as_mapped" class="fn">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.quarantine_address_range" class="fn">quarantine_address_range</a>(
        &amp;self,
        start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>,
        pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.77.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.ensure_mapped" class="fn">ensure_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.77.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_mapped_address" class="fn">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.protect" class="fn">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generic mmap and protection functionality</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.set_mmap_strategy" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#12">source</a><h4 class="code-header">fn <a href="#tymethod.set_mmap_strategy" class="fn">set_mmap_strategy</a>(&amp;self, strategy: <a class="enum" href="../../../memory/enum.MmapStrategy.html" title="enum mmtk::util::memory::MmapStrategy">MmapStrategy</a>)</h4></section></summary><div class="docblock"><p>Set mmap strategy</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.eagerly_mmap_all_spaces" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#20">source</a><h4 class="code-header">fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fn">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>])</h4></section></summary><div class="docblock"><p>Given an address array describing the regions of virtual memory to be used
by MMTk, demand zero map all of them if they are not already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>spaceMap</code>: An address array containing a pairs of start and end
addresses for each of the regions to be mapped</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.mark_as_mapped" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#29">source</a><h4 class="code-header">fn <a href="#tymethod.mark_as_mapped" class="fn">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as mapped, without making any
request to the operating system.  Used to mark pages
that the VM has already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be mapped</li>
<li><code>bytes</code>: Number of bytes to ensure mapped</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.quarantine_address_range" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#38">source</a><h4 class="code-header">fn <a href="#tymethod.quarantine_address_range" class="fn">quarantine_address_range</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.77.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Quarantine/reserve address range. We mmap from the OS with no reserve and with PROT_NONE,
which should be little overhead. This ensures that we can reserve certain address range that
we can use if needed. Quarantined memory needs to be mapped before it can be used.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be quarantined</li>
<li><code>bytes</code>: Number of bytes to quarantine from the start</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.ensure_mapped" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#50">source</a><h4 class="code-header">fn <a href="#tymethod.ensure_mapped" class="fn">ensure_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.77.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Ensure that a range of pages is mmapped (or equivalent).  If the
pages are not yet mapped, demand-zero map them. Note that mapping
occurs at chunk granularity, not page granularity.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: The start of the range to be mapped.</li>
<li><code>pages</code>: The size of the range to be mapped, in pages</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.is_mapped_address" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#57">source</a><h4 class="code-header">fn <a href="#tymethod.is_mapped_address" class="fn">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Is the page pointed to by this address mapped? Returns true if
the page at the given address is mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>addr</code>: Address in question</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.protect" class="method"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#64">source</a><h4 class="code-header">fn <a href="#tymethod.protect" class="fn">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.77.0/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as inaccessible.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be protected</li>
<li><code>pages</code>: Number of pages to be protected</li>
</ul>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-Mmapper-for-ByteMapMmapper" class="impl"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/byte_map_mmapper.rs.html#36-133">source</a><a href="#impl-Mmapper-for-ByteMapMmapper" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Mmapper.html" title="trait mmtk::util::heap::layout::mmapper::Mmapper">Mmapper</a> for <a class="struct" href="../byte_map_mmapper/struct.ByteMapMmapper.html" title="struct mmtk::util::heap::layout::byte_map_mmapper::ByteMapMmapper">ByteMapMmapper</a></h3></section><section id="impl-Mmapper-for-FragmentedMapper" class="impl"><a class="src rightside" href="../../../../../src/mmtk/util/heap/layout/fragmented_mapper.rs.html#70-228">source</a><a href="#impl-Mmapper-for-FragmentedMapper" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Mmapper.html" title="trait mmtk::util::heap::layout::mmapper::Mmapper">Mmapper</a> for <a class="struct" href="../fragmented_mapper/struct.FragmentedMapper.html" title="struct mmtk::util::heap::layout::fragmented_mapper::FragmentedMapper">FragmentedMapper</a></h3></section></div><script src="../../../../../trait.impl/mmtk/util/heap/layout/mmapper/trait.Mmapper.js" async></script></section></div></main></body></html>
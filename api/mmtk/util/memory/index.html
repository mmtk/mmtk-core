<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Wrapper functions for memory syscalls such as mmap, mprotect, etc."><title>mmtk::util::memory - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0 (aedd173a2 2024-03-17)" data-channel="1.77.0" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-4c98445ec4002617.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../mmtk/index.html">mmtk</a><span class="version">0.24.0-698a7374fbfaccdd141bbd9d8cd6c2eba2290217</span></h2></div><h2 class="location"><a href="#">Module memory</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In mmtk::util</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../../mmtk/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press â€˜Sâ€™ to search, â€˜?â€™ for more optionsâ€¦" type="search"><div id="help-button" tabindex="-1"><a href="../../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">mmtk</a>::<wbr><a href="../index.html">util</a>::<wbr><a class="mod" href="#">memory</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/mmtk/util/memory.rs.html#1-435">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Wrapper functions for memory syscalls such as mmap, mprotect, etc.</p>
</div></details><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.MmapStrategy.html" title="enum mmtk::util::memory::MmapStrategy">MmapStrategy</a></div><div class="desc docblock-short">Strategy for performing mmap</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.MMAP_FLAGS.html" title="constant mmtk::util::memory::MMAP_FLAGS">MMAP_FLAGS</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="constant" href="constant.MMAP_PROT.html" title="constant mmtk::util::memory::MMAP_PROT">MMAP_PROT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.dzmmap.html" title="fn mmtk::util::memory::dzmmap">dzmmap</a><sup title="unsafe function">âš </sup></div><div class="desc docblock-short">Demand-zero mmap:
This function mmaps the memory and guarantees to zero all mapped memory.
This function WILL overwrite existing memory mapping. The user of this function
needs to be aware of this, and use it cautiously.</div></li><li><div class="item-name"><a class="fn" href="fn.dzmmap_noreplace.html" title="fn mmtk::util::memory::dzmmap_noreplace">dzmmap_noreplace</a></div><div class="desc docblock-short">Demand-zero mmap (no replace):
This function mmaps the memory and guarantees to zero all mapped memory.
This function will not overwrite existing memory mapping, and it will result Err if there is an existing mapping.</div></li><li><div class="item-name"><a class="fn" href="fn.get_process_memory_maps.html" title="fn mmtk::util::memory::get_process_memory_maps">get_process_memory_maps</a></div><div class="desc docblock-short">Get the memory maps for the process. The returned string is a multi-line string.
This is only meant to be used for debugging. For example, log process memory maps after detecting a clash.</div></li><li><div class="item-name"><a class="fn" href="fn.get_system_total_memory.html" title="fn mmtk::util::memory::get_system_total_memory">get_system_total_memory</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Returns the total physical memory for the system in bytes.</div></li><li><div class="item-name"><a class="fn" href="fn.handle_mmap_error.html" title="fn mmtk::util::memory::handle_mmap_error">handle_mmap_error</a></div><div class="desc docblock-short">Properly handle errors from a mmap Result, including invoking the binding code in the case of
an OOM error.</div></li><li><div class="item-name"><a class="fn" href="fn.mmap_fixed.html" title="fn mmtk::util::memory::mmap_fixed">mmap_fixed</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.mmap_noreserve.html" title="fn mmtk::util::memory::mmap_noreserve">mmap_noreserve</a></div><div class="desc docblock-short">mmap with no swap space reserve:
This function does not reserve swap space for this mapping, which means there is no guarantee that writes to the
mapping can always be successful. In case of out of physical memory, one may get a segfault for writing to the mapping.
We can use this to reserve the address range, and then later overwrites the mapping with dzmmap().</div></li><li><div class="item-name"><a class="fn" href="fn.mprotect.html" title="fn mmtk::util::memory::mprotect">mprotect</a></div><div class="desc docblock-short">Protect the given memory (in page granularity) to forbid any access (PROT_NONE).</div></li><li><div class="item-name"><a class="fn" href="fn.munmap.html" title="fn mmtk::util::memory::munmap">munmap</a></div><div class="desc docblock-short">Unmap the given memory (in page granularity). This wraps the unsafe libc munmap call.</div></li><li><div class="item-name"><a class="fn" href="fn.munprotect.html" title="fn mmtk::util::memory::munprotect">munprotect</a></div><div class="desc docblock-short">Unprotect the given memory (in page granularity) to allow access (PROT_READ/WRITE/EXEC).</div></li><li><div class="item-name"><a class="fn" href="fn.panic_if_unmapped.html" title="fn mmtk::util::memory::panic_if_unmapped">panic_if_unmapped</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Checks if the memory has already been mapped. If not, we panic.
Note that the checking has a side effect that it will map the memory if it was unmapped. So we panic if it was unmapped.
Be very careful about using this function.</div></li><li><div class="item-name"><a class="fn" href="fn.result_is_mapped.html" title="fn mmtk::util::memory::result_is_mapped">result_is_mapped</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Check the result from an mmap function in this module.
Return true if the mmap has failed due to an existing conflicting mapping.</div></li><li><div class="item-name"><a class="fn" href="fn.set.html" title="fn mmtk::util::memory::set">set</a></div><div class="desc docblock-short">Set a range of memory to the given value. Similar to memset.</div></li><li><div class="item-name"><a class="fn" href="fn.wrap_libc_call.html" title="fn mmtk::util::memory::wrap_libc_call">wrap_libc_call</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.zero.html" title="fn mmtk::util::memory::zero">zero</a></div><div class="desc docblock-short">Set a range of memory to 0.</div></li></ul></section></div></main></body></html>
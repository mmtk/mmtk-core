<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Wrapper functions for memory syscalls such as mmap, mprotect, etc."><title>mmtk::util::memory - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../mmtk/index.html">mmtk</a><span class="version">0.31.0-9f862ad2e3588440f3bf8e98a65df452187b2dd6</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module memory</a></h2><h3><a href="#macros">Module Items</a></h3><ul class="block"><li><a href="#macros" title="Macros">Macros</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In mmtk::<wbr>util</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">mmtk</a>::<wbr><a href="../index.html">util</a></span><h1>Module <span>memory</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/mmtk/util/memory.rs.html#1-672">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Wrapper functions for memory syscalls such as mmap, mprotect, etc.</p>
</div></details><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.mmap_anno_test.html" title="macro mmtk::util::memory::mmap_anno_test">mmap_<wbr>anno_<wbr>test</a></div><div class="desc docblock-short">Construct an <code>MmapAnnotation::Test</code> with the current file name and line number.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.MmapStrategy.html" title="struct mmtk::util::memory::MmapStrategy">Mmap<wbr>Strategy</a></div><div class="desc docblock-short">Strategy for performing mmap</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.HugePageSupport.html" title="enum mmtk::util::memory::HugePageSupport">Huge<wbr>Page<wbr>Support</a></div><div class="desc docblock-short">Support for huge pages</div></li><li><div class="item-name"><a class="enum" href="enum.MmapAnnotation.html" title="enum mmtk::util::memory::MmapAnnotation">Mmap<wbr>Annotation</a></div><div class="desc docblock-short">Annotation for an mmap entry.</div></li><li><div class="item-name"><a class="enum" href="enum.MmapProtection.html" title="enum mmtk::util::memory::MmapProtection">Mmap<wbr>Protection</a></div><div class="desc docblock-short">The protection flags for Mmap</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.MMAP_FLAGS.html" title="constant mmtk::util::memory::MMAP_FLAGS">MMAP_<wbr>FLAGS</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.dzmmap.html" title="fn mmtk::util::memory::dzmmap">dzmmap</a><sup title="unsafe function">âš </sup></div><div class="desc docblock-short">Demand-zero mmap:
This function mmaps the memory and guarantees to zero all mapped memory.
This function WILL overwrite existing memory mapping. The user of this function
needs to be aware of this, and use it cautiously.</div></li><li><div class="item-name"><a class="fn" href="fn.dzmmap_noreplace.html" title="fn mmtk::util::memory::dzmmap_noreplace">dzmmap_<wbr>noreplace</a></div><div class="desc docblock-short">Demand-zero mmap (no replace):
This function mmaps the memory and guarantees to zero all mapped memory.
This function will not overwrite existing memory mapping, and it will result Err if there is an existing mapping.</div></li><li><div class="item-name"><a class="fn" href="fn.get_process_memory_maps.html" title="fn mmtk::util::memory::get_process_memory_maps">get_<wbr>process_<wbr>memory_<wbr>maps</a></div><div class="desc docblock-short">Get the memory maps for the process. The returned string is a multi-line string.
This is only meant to be used for debugging. For example, log process memory maps after detecting a clash.</div></li><li><div class="item-name"><a class="fn" href="fn.get_system_total_memory.html" title="fn mmtk::util::memory::get_system_total_memory">get_<wbr>system_<wbr>total_<wbr>memory</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Returns the total physical memory for the system in bytes.</div></li><li><div class="item-name"><a class="fn" href="fn.handle_mmap_error.html" title="fn mmtk::util::memory::handle_mmap_error">handle_<wbr>mmap_<wbr>error</a></div><div class="desc docblock-short">Properly handle errors from a mmap Result, including invoking the binding code in the case of
an OOM error.</div></li><li><div class="item-name"><a class="fn" href="fn.mmap_fixed.html" title="fn mmtk::util::memory::mmap_fixed">mmap_<wbr>fixed</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.mmap_noreserve.html" title="fn mmtk::util::memory::mmap_noreserve">mmap_<wbr>noreserve</a></div><div class="desc docblock-short">mmap with no swap space reserve:
This function does not reserve swap space for this mapping, which means there is no guarantee that writes to the
mapping can always be successful. In case of out of physical memory, one may get a segfault for writing to the mapping.
We can use this to reserve the address range, and then later overwrites the mapping with dzmmap().</div></li><li><div class="item-name"><a class="fn" href="fn.mprotect.html" title="fn mmtk::util::memory::mprotect">mprotect</a></div><div class="desc docblock-short">Protect the given memory (in page granularity) to forbid any access (PROT_NONE).</div></li><li><div class="item-name"><a class="fn" href="fn.munmap.html" title="fn mmtk::util::memory::munmap">munmap</a></div><div class="desc docblock-short">Unmap the given memory (in page granularity). This wraps the unsafe libc munmap call.</div></li><li><div class="item-name"><a class="fn" href="fn.munprotect.html" title="fn mmtk::util::memory::munprotect">munprotect</a></div><div class="desc docblock-short">Unprotect the given memory (in page granularity) to allow access (PROT_READ/WRITE/EXEC).</div></li><li><div class="item-name"><a class="fn" href="fn.panic_if_unmapped.html" title="fn mmtk::util::memory::panic_if_unmapped">panic_<wbr>if_<wbr>unmapped</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Checks if the memory has already been mapped. If not, we panic.</div></li><li><div class="item-name"><a class="fn" href="fn.result_is_mapped.html" title="fn mmtk::util::memory::result_is_mapped">result_<wbr>is_<wbr>mapped</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Check the result from an mmap function in this module.
Return true if the mmap has failed due to an existing conflicting mapping.</div></li><li><div class="item-name"><a class="fn" href="fn.set.html" title="fn mmtk::util::memory::set">set</a></div><div class="desc docblock-short">Set a range of memory to the given value. Similar to memset.</div></li><li><div class="item-name"><a class="fn" href="fn.wrap_libc_call.html" title="fn mmtk::util::memory::wrap_libc_call">wrap_<wbr>libc_<wbr>call</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.zero.html" title="fn mmtk::util::memory::zero">zero</a></div><div class="desc docblock-short">Set a range of memory to 0.</div></li></ul></section></div></main></body></html>
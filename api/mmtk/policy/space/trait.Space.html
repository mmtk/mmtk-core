<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `Space` trait in crate `mmtk`."><title>Space in mmtk::policy::space - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="mmtk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../mmtk/index.html">mmtk</a><span class="version">0.31.0-9a3f356609dd8f4b5c8770012102ea49299801d6</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Space</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.as_sft" title="as_sft">as_sft</a></li><li><a href="#tymethod.as_space" title="as_space">as_space</a></li><li><a href="#tymethod.common" title="common">common</a></li><li><a href="#tymethod.enumerate_objects" title="enumerate_objects">enumerate_objects</a></li><li><a href="#tymethod.get_page_resource" title="get_page_resource">get_page_resource</a></li><li><a href="#tymethod.initialize_sft" title="initialize_sft">initialize_sft</a></li><li><a href="#tymethod.maybe_get_page_resource_mut" title="maybe_get_page_resource_mut">maybe_get_page_resource_mut</a></li><li><a href="#tymethod.release_multiple_pages" title="release_multiple_pages">release_multiple_pages</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.acquire" title="acquire">acquire</a></li><li><a href="#method.address_in_space" title="address_in_space">address_in_space</a></li><li><a href="#method.available_physical_pages" title="available_physical_pages">available_physical_pages</a></li><li><a href="#method.ensure_mapped" title="ensure_mapped">ensure_mapped</a></li><li><a href="#method.estimate_side_meta_pages" title="estimate_side_meta_pages">estimate_side_meta_pages</a></li><li><a href="#method.get_descriptor" title="get_descriptor">get_descriptor</a></li><li><a href="#method.get_gc_trigger" title="get_gc_trigger">get_gc_trigger</a></li><li><a href="#method.get_name" title="get_name">get_name</a></li><li><a href="#method.grow_space" title="grow_space">grow_space</a></li><li><a href="#method.handle_obvious_oom_request" title="handle_obvious_oom_request">handle_obvious_oom_request</a></li><li><a href="#method.in_space" title="in_space">in_space</a></li><li><a href="#method.reserved_pages" title="reserved_pages">reserved_pages</a></li><li><a href="#method.set_copy_for_sft_trace" title="set_copy_for_sft_trace">set_copy_for_sft_trace</a></li><li><a href="#method.verify_side_metadata_sanity" title="verify_side_metadata_sanity">verify_side_metadata_sanity</a></li><li><a href="#method.will_oom_on_acquire" title="will_oom_on_acquire">will_oom_on_acquire</a></li></ul><h3><a href="#implementations">Methods</a></h3><ul class="block method"><li><a href="#method.downcast" title="downcast">downcast</a></li><li><a href="#method.downcast_mut" title="downcast_mut">downcast_mut</a></li><li><a href="#method.downcast_rc" title="downcast_rc">downcast_rc</a></li><li><a href="#method.downcast_ref" title="downcast_ref">downcast_ref</a></li><li><a href="#method.is" title="is">is</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In mmtk::<wbr>policy::<wbr>space</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">mmtk</a>::<wbr><a href="../index.html">policy</a>::<wbr><a href="index.html">space</a></span><h1>Trait <span class="trait">Space</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/mmtk/policy/space.rs.html#42-436">source</a> </span></div><pre class="rust item-decl"><code>pub trait Space&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt;:
    'static
    + <a class="trait" href="../sft/trait.SFT.html" title="trait mmtk::policy::sft::SFT">SFT</a>
    + <a class="trait" href="https://doc.rust-lang.org/1.83.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>
    + Downcast {
<details class="toggle type-contents-toggle"><summary class="hideme"><span>Show 23 methods</span></summary>    // Required methods
    fn <a href="#tymethod.as_space" class="fn">as_space</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.as_sft" class="fn">as_sft</a>(&amp;self) -&gt; &amp;(dyn <a class="trait" href="../sft/trait.SFT.html" title="trait mmtk::policy::sft::SFT">SFT</a> + <a class="trait" href="https://doc.rust-lang.org/1.83.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + 'static);
<span class="item-spacer"></span>    fn <a href="#tymethod.get_page_resource" class="fn">get_page_resource</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="../../util/heap/pageresource/trait.PageResource.html" title="trait mmtk::util::heap::pageresource::PageResource">PageResource</a>&lt;VM&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.maybe_get_page_resource_mut" class="fn">maybe_get_page_resource_mut</a>(
        &amp;mut self,
    ) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;mut dyn <a class="trait" href="../../util/heap/pageresource/trait.PageResource.html" title="trait mmtk::util::heap::pageresource::PageResource">PageResource</a>&lt;VM&gt;&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.initialize_sft" class="fn">initialize_sft</a>(&amp;self, sft_map: &amp;mut dyn <a class="trait" href="../sft_map/trait.SFTMap.html" title="trait mmtk::policy::sft_map::SFTMap">SFTMap</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.common" class="fn">common</a>(&amp;self) -&gt; &amp;<a class="struct" href="struct.CommonSpace.html" title="struct mmtk::policy::space::CommonSpace">CommonSpace</a>&lt;VM&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.release_multiple_pages" class="fn">release_multiple_pages</a>(&amp;mut self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.enumerate_objects" class="fn">enumerate_objects</a>(&amp;self, enumerator: &amp;mut dyn <a class="trait" href="../../util/object_enum/trait.ObjectEnumerator.html" title="trait mmtk::util::object_enum::ObjectEnumerator">ObjectEnumerator</a>);

    // Provided methods
    fn <a href="#method.will_oom_on_acquire" class="fn">will_oom_on_acquire</a>(&amp;self, size: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.handle_obvious_oom_request" class="fn">handle_obvious_oom_request</a>(
        &amp;self,
        tls: <a class="struct" href="../../util/opaque_pointer/struct.VMThread.html" title="struct mmtk::util::opaque_pointer::VMThread">VMThread</a>,
        size: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
        alloc_options: <a class="struct" href="../../util/alloc/allocator/struct.AllocationOptions.html" title="struct mmtk::util::alloc::allocator::AllocationOptions">AllocationOptions</a>,
    ) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.acquire" class="fn">acquire</a>(
        &amp;self,
        tls: <a class="struct" href="../../util/opaque_pointer/struct.VMThread.html" title="struct mmtk::util::opaque_pointer::VMThread">VMThread</a>,
        pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
        alloc_options: <a class="struct" href="../../util/alloc/allocator/struct.AllocationOptions.html" title="struct mmtk::util::alloc::allocator::AllocationOptions">AllocationOptions</a>,
    ) -&gt; <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.address_in_space" class="fn">address_in_space</a>(&amp;self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.in_space" class="fn">in_space</a>(&amp;self, object: <a class="struct" href="../../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.grow_space" class="fn">grow_space</a>(&amp;self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>, new_chunk: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a>) { ... }
<span class="item-spacer"></span>    fn <a href="#method.ensure_mapped" class="fn">ensure_mapped</a>(&amp;self) { ... }
<span class="item-spacer"></span>    fn <a href="#method.estimate_side_meta_pages" class="fn">estimate_side_meta_pages</a>(&amp;self, data_pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.reserved_pages" class="fn">reserved_pages</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.available_physical_pages" class="fn">available_physical_pages</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_name" class="fn">get_name</a>(&amp;self) -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.str.html">str</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_descriptor" class="fn">get_descriptor</a>(&amp;self) -&gt; <a class="struct" href="../../util/heap/space_descriptor/struct.SpaceDescriptor.html" title="struct mmtk::util::heap::space_descriptor::SpaceDescriptor">SpaceDescriptor</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_gc_trigger" class="fn">get_gc_trigger</a>(&amp;self) -&gt; &amp;<a class="struct" href="../../util/heap/gc_trigger/struct.GCTrigger.html" title="struct mmtk::util::heap::gc_trigger::GCTrigger">GCTrigger</a>&lt;VM&gt; { ... }
<span class="item-spacer"></span>    fn <a href="#method.set_copy_for_sft_trace" class="fn">set_copy_for_sft_trace</a>(&amp;mut self, _semantics: <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="enum" href="../../util/copy/enum.CopySemantics.html" title="enum mmtk::util::copy::CopySemantics">CopySemantics</a>&gt;) { ... }
<span class="item-spacer"></span>    fn <a href="#method.verify_side_metadata_sanity" class="fn">verify_side_metadata_sanity</a>(
        &amp;self,
        side_metadata_sanity_checker: &amp;mut <a class="struct" href="../../util/metadata/side_metadata/sanity/struct.SideMetadataSanity.html" title="struct mmtk::util::metadata::side_metadata::sanity::SideMetadataSanity">SideMetadataSanity</a>,
    ) { ... }
</details>}</code></pre><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><section id="tymethod.as_space" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#43">source</a><h4 class="code-header">fn <a href="#tymethod.as_space" class="fn">as_space</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;</h4></section><section id="tymethod.as_sft" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#44">source</a><h4 class="code-header">fn <a href="#tymethod.as_sft" class="fn">as_sft</a>(&amp;self) -&gt; &amp;(dyn <a class="trait" href="../sft/trait.SFT.html" title="trait mmtk::policy::sft::SFT">SFT</a> + <a class="trait" href="https://doc.rust-lang.org/1.83.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + 'static)</h4></section><section id="tymethod.get_page_resource" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#45">source</a><h4 class="code-header">fn <a href="#tymethod.get_page_resource" class="fn">get_page_resource</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="../../util/heap/pageresource/trait.PageResource.html" title="trait mmtk::util::heap::pageresource::PageResource">PageResource</a>&lt;VM&gt;</h4></section><details class="toggle method-toggle" open><summary><section id="tymethod.maybe_get_page_resource_mut" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#49">source</a><h4 class="code-header">fn <a href="#tymethod.maybe_get_page_resource_mut" class="fn">maybe_get_page_resource_mut</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;mut dyn <a class="trait" href="../../util/heap/pageresource/trait.PageResource.html" title="trait mmtk::util::heap::pageresource::PageResource">PageResource</a>&lt;VM&gt;&gt;</h4></section></summary><div class="docblock"><p>Get a mutable reference to the underlying page resource, or <code>None</code> if the space does not
have a page resource.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.initialize_sft" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#54">source</a><h4 class="code-header">fn <a href="#tymethod.initialize_sft" class="fn">initialize_sft</a>(&amp;self, sft_map: &amp;mut dyn <a class="trait" href="../sft_map/trait.SFTMap.html" title="trait mmtk::policy::sft_map::SFTMap">SFTMap</a>)</h4></section></summary><div class="docblock"><p>Initialize entires in SFT map for the space. This is called when the Space object
has a non-moving address, as we will use the address to set sft.
Currently after we create a boxed plan, spaces in the plan have a non-moving address.</p>
</div></details><section id="tymethod.common" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#388">source</a><h4 class="code-header">fn <a href="#tymethod.common" class="fn">common</a>(&amp;self) -&gt; &amp;<a class="struct" href="struct.CommonSpace.html" title="struct mmtk::policy::space::CommonSpace">CommonSpace</a>&lt;VM&gt;</h4></section><section id="tymethod.release_multiple_pages" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#393">source</a><h4 class="code-header">fn <a href="#tymethod.release_multiple_pages" class="fn">release_multiple_pages</a>(&amp;mut self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>)</h4></section><details class="toggle method-toggle" open><summary><section id="tymethod.enumerate_objects" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#435">source</a><h4 class="code-header">fn <a href="#tymethod.enumerate_objects" class="fn">enumerate_objects</a>(&amp;self, enumerator: &amp;mut dyn <a class="trait" href="../../util/object_enum/trait.ObjectEnumerator.html" title="trait mmtk::util::object_enum::ObjectEnumerator">ObjectEnumerator</a>)</h4></section></summary><div class="docblock"><p>Enumerate objects in the current space.</p>
<p>Implementers can use the <code>enumerator</code> to report</p>
<ul>
<li>individual objects within the space using <code>enumerator.visit_object</code>, and</li>
<li>ranges of address that may contain objects using <code>enumerator.visit_address_range</code>. The
caller will then enumerate objects in the range using the VO bits metadata.</li>
</ul>
<p>Each object in the space shall be covered by one of the two methods above.</p>
<h5 id="implementation-considerations"><a class="doc-anchor" href="#implementation-considerations">§</a>Implementation considerations</h5>
<p><strong>Skipping empty ranges</strong>: When enumerating address ranges, spaces can skip ranges (blocks,
chunks, etc.) that are guarenteed not to contain objects.</p>
<p><strong>Dynamic dispatch</strong>: Because <code>Space</code> is a trait object type and <code>enumerator</code> is a <code>dyn</code>
reference, invoking methods of <code>enumerator</code> involves a dynamic dispatching.  But the
overhead is OK if we call it a block at a time because scanning the VO bits will dominate
the execution time.  For LOS, it will be cheaper to enumerate individual objects than
scanning VO bits because it is sparse.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.will_oom_on_acquire" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#71-75">source</a><h4 class="code-header">fn <a href="#method.will_oom_on_acquire" class="fn">will_oom_on_acquire</a>(&amp;self, size: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>A check for the obvious out-of-memory case: if the requested size is larger than
the heap size, it is definitely an OOM. We would like to identify that, and
allows the binding to deal with OOM. Without this check, we will attempt
to allocate from the page resource. If the requested size is unrealistically large
(such as <code>usize::MAX</code>), it breaks the assumptions of our implementation of
page resource, vm map, etc. This check prevents that, and allows us to
handle the OOM case.
Each allocator that may request an arbitrary size should call this method before
acquring memory from the space. For example, bump pointer allocator and large object
allocator need to call this method. On the other hand, allocators that only allocate
memory in fixed size blocks do not need to call this method.
An allocator should call this method before doing any computation on the size to
avoid arithmatic overflow. If we have to do computation in the allocation fastpath and
overflow happens there, there is nothing we can do about it.
Return a boolean to indicate if we will be out of memory, determined by the check.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.handle_obvious_oom_request" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#80-96">source</a><h4 class="code-header">fn <a href="#method.handle_obvious_oom_request" class="fn">handle_obvious_oom_request</a>(
    &amp;self,
    tls: <a class="struct" href="../../util/opaque_pointer/struct.VMThread.html" title="struct mmtk::util::opaque_pointer::VMThread">VMThread</a>,
    size: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
    alloc_options: <a class="struct" href="../../util/alloc/allocator/struct.AllocationOptions.html" title="struct mmtk::util::alloc::allocator::AllocationOptions">AllocationOptions</a>,
) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Check if the requested <code>size</code> is an obvious out-of-memory case using
<a href="trait.Space.html#method.will_oom_on_acquire"><code>Self::will_oom_on_acquire</code></a> and, if it is, call <code>Collection::out_of_memory</code>.  Return the
result of <code>will_oom_on_acquire</code>.</p>
</div></details><section id="method.acquire" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#98-283">source</a><h4 class="code-header">fn <a href="#method.acquire" class="fn">acquire</a>(
    &amp;self,
    tls: <a class="struct" href="../../util/opaque_pointer/struct.VMThread.html" title="struct mmtk::util::opaque_pointer::VMThread">VMThread</a>,
    pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>,
    alloc_options: <a class="struct" href="../../util/alloc/allocator/struct.AllocationOptions.html" title="struct mmtk::util::alloc::allocator::AllocationOptions">AllocationOptions</a>,
) -&gt; <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a></h4></section><section id="method.address_in_space" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#285-291">source</a><h4 class="code-header">fn <a href="#method.address_in_space" class="fn">address_in_space</a>(&amp;self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section><section id="method.in_space" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#293-295">source</a><h4 class="code-header">fn <a href="#method.in_space" class="fn">in_space</a>(&amp;self, object: <a class="struct" href="../../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section><details class="toggle method-toggle" open><summary><section id="method.grow_space" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#306-340">source</a><h4 class="code-header">fn <a href="#method.grow_space" class="fn">grow_space</a>(&amp;self, start: <a class="struct" href="../../util/address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>, new_chunk: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a>)</h4></section></summary><div class="docblock"><p>This is called after we get result from page resources.  The space may
tap into the hook to monitor heap growth.  The call is made from within the
page resources’ critical region, immediately before yielding the lock.</p>
<p>@param start The start of the newly allocated space
@param bytes The size of the newly allocated space
@param new_chunk {@code true} if the new space encroached upon or started a new chunk or chunks.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.ensure_mapped" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#344-356">source</a><h4 class="code-header">fn <a href="#method.ensure_mapped" class="fn">ensure_mapped</a>(&amp;self)</h4></section></summary><div class="docblock"><p>Ensure this space is marked as mapped – used when the space is already
mapped (e.g. for a vm image which is externally mmapped.)</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.estimate_side_meta_pages" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#365-367">source</a><h4 class="code-header">fn <a href="#method.estimate_side_meta_pages" class="fn">estimate_side_meta_pages</a>(&amp;self, data_pages: <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a></h4></section></summary><div class="docblock"><p>Estimate the amount of side metadata memory needed for a give data memory size in pages. The
result will over-estimate the amount of metadata pages needed, with at least one page per
side metadata.  This relatively accurately describes the number of side metadata pages the
space actually consumes.</p>
<p>This function is used for both triggering GC (via <a href="trait.Space.html#method.reserved_pages" title="method mmtk::policy::space::Space::reserved_pages"><code>Space::reserved_pages</code></a>) and resizing
the heap (via <a href="../../util/heap/gc_trigger/trait.GCTriggerPolicy.html#method.on_pending_allocation" title="method mmtk::util::heap::gc_trigger::GCTriggerPolicy::on_pending_allocation"><code>crate::util::heap::GCTriggerPolicy::on_pending_allocation</code></a>).</p>
</div></details><section id="method.reserved_pages" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#369-373">source</a><h4 class="code-header">fn <a href="#method.reserved_pages" class="fn">reserved_pages</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a></h4></section><details class="toggle method-toggle" open><summary><section id="method.available_physical_pages" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#376-378">source</a><h4 class="code-header">fn <a href="#method.available_physical_pages" class="fn">available_physical_pages</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.usize.html">usize</a></h4></section></summary><div class="docblock"><p>Return the number of physical pages available.</p>
</div></details><section id="method.get_name" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#380-382">source</a><h4 class="code-header">fn <a href="#method.get_name" class="fn">get_name</a>(&amp;self) -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.str.html">str</a></h4></section><section id="method.get_descriptor" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#384-386">source</a><h4 class="code-header">fn <a href="#method.get_descriptor" class="fn">get_descriptor</a>(&amp;self) -&gt; <a class="struct" href="../../util/heap/space_descriptor/struct.SpaceDescriptor.html" title="struct mmtk::util::heap::space_descriptor::SpaceDescriptor">SpaceDescriptor</a></h4></section><section id="method.get_gc_trigger" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#389-391">source</a><h4 class="code-header">fn <a href="#method.get_gc_trigger" class="fn">get_gc_trigger</a>(&amp;self) -&gt; &amp;<a class="struct" href="../../util/heap/gc_trigger/struct.GCTrigger.html" title="struct mmtk::util::heap::gc_trigger::GCTrigger">GCTrigger</a>&lt;VM&gt;</h4></section><details class="toggle method-toggle" open><summary><section id="method.set_copy_for_sft_trace" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#397-399">source</a><h4 class="code-header">fn <a href="#method.set_copy_for_sft_trace" class="fn">set_copy_for_sft_trace</a>(&amp;mut self, _semantics: <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="enum" href="../../util/copy/enum.CopySemantics.html" title="enum mmtk::util::copy::CopySemantics">CopySemantics</a>&gt;)</h4></section></summary><div class="docblock"><p>What copy semantic we should use for this space if we copy objects from this space.
This is only needed for plans that use SFTProcessEdges</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.verify_side_metadata_sanity" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#410-413">source</a><h4 class="code-header">fn <a href="#method.verify_side_metadata_sanity" class="fn">verify_side_metadata_sanity</a>(
    &amp;self,
    side_metadata_sanity_checker: &amp;mut <a class="struct" href="../../util/metadata/side_metadata/sanity/struct.SideMetadataSanity.html" title="struct mmtk::util::metadata::side_metadata::sanity::SideMetadataSanity">SideMetadataSanity</a>,
)</h4></section></summary><div class="docblock"><p>Ensure that the current space’s metadata context does not have any issues.
Panics with a suitable message if any issue is detected.
It also initialises the sanity maps which will then be used if the <code>extreme_assertions</code> feature is active.
Internally this calls verify_metadata_context() from <code>util::metadata::sanity</code></p>
<p>This function is called once per space by its parent plan but may be called multiple times per policy.</p>
<p>Arguments:</p>
<ul>
<li><code>side_metadata_sanity_checker</code>: The <code>SideMetadataSanity</code> object instantiated in the calling plan.</li>
</ul>
</div></details></div><h2 id="implementations" class="section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-dyn+Space%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><a href="#impl-dyn+Space%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM&gt; dyn <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;<div class="where">where
    VM: <a class="trait" href="https://doc.rust-lang.org/1.83.0/core/any/trait.Any.html" title="trait core::any::Any">Any</a> + 'static + <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.is" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><h4 class="code-header">pub fn <a href="#method.is" class="fn">is</a>&lt;__T: <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;&gt;(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Returns true if the trait object wraps an object of type <code>__T</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downcast" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><h4 class="code-header">pub fn <a href="#method.downcast" class="fn">downcast</a>&lt;__T: <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;&gt;(self: <a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;Self&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;__T&gt;, <a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;Self&gt;&gt;</h4></section></summary><div class="docblock"><p>Returns a boxed object from a boxed trait object if the underlying object is of type
<code>__T</code>. Returns the original boxed trait if it isn’t.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downcast_rc" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><h4 class="code-header">pub fn <a href="#method.downcast_rc" class="fn">downcast_rc</a>&lt;__T: <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;&gt;(self: <a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;Self&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;__T&gt;, <a class="struct" href="https://doc.rust-lang.org/1.83.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;Self&gt;&gt;</h4></section></summary><div class="docblock"><p>Returns an <code>Rc</code>-ed object from an <code>Rc</code>-ed trait object if the underlying object is of
type <code>__T</code>. Returns the original <code>Rc</code>-ed trait if it isn’t.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downcast_ref" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><h4 class="code-header">pub fn <a href="#method.downcast_ref" class="fn">downcast_ref</a>&lt;__T: <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;&gt;(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.reference.html">&amp;__T</a>&gt;</h4></section></summary><div class="docblock"><p>Returns a reference to the object within the trait object if it is of type <code>__T</code>, or
<code>None</code> if it isn’t.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downcast_mut" class="method"><a class="src rightside" href="../../../src/mmtk/policy/space.rs.html#498">source</a><h4 class="code-header">pub fn <a href="#method.downcast_mut" class="fn">downcast_mut</a>&lt;__T: <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt;&gt;(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.83.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.83.0/std/primitive.reference.html">&amp;mut __T</a>&gt;</h4></section></summary><div class="docblock"><p>Returns a mutable reference to the object within the trait object if it is of type
<code>__T</code>, or <code>None</code> if it isn’t.</p>
</div></details></div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-Space%3CVM%3E-for-CompressorSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/compressor/compressorspace.rs.html#117-149">source</a><a href="#impl-Space%3CVM%3E-for-CompressorSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../compressor/compressorspace/struct.CompressorSpace.html" title="struct mmtk::policy::compressor::compressorspace::CompressorSpace">CompressorSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-CopySpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/copyspace.rs.html#110-146">source</a><a href="#impl-Space%3CVM%3E-for-CopySpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../copyspace/struct.CopySpace.html" title="struct mmtk::policy::copyspace::CopySpace">CopySpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-ImmixSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/immix/immixspace.rs.html#177-206">source</a><a href="#impl-Space%3CVM%3E-for-ImmixSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../immix/immixspace/struct.ImmixSpace.html" title="struct mmtk::policy::immix::immixspace::ImmixSpace">ImmixSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-ImmortalSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/immortalspace.rs.html#90-118">source</a><a href="#impl-Space%3CVM%3E-for-ImmortalSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../immortalspace/struct.ImmortalSpace.html" title="struct mmtk::policy::immortalspace::ImmortalSpace">ImmortalSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-LargeObjectSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/largeobjectspace.rs.html#166-195">source</a><a href="#impl-Space%3CVM%3E-for-LargeObjectSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../largeobjectspace/struct.LargeObjectSpace.html" title="struct mmtk::policy::largeobjectspace::LargeObjectSpace">LargeObjectSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-LockFreeImmortalSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/lockfreeimmortalspace.rs.html#104-184">source</a><a href="#impl-Space%3CVM%3E-for-LockFreeImmortalSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../lockfreeimmortalspace/struct.LockFreeImmortalSpace.html" title="struct mmtk::policy::lockfreeimmortalspace::LockFreeImmortalSpace">LockFreeImmortalSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-MarkCompactSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/markcompactspace.rs.html#114-146">source</a><a href="#impl-Space%3CVM%3E-for-MarkCompactSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../markcompactspace/struct.MarkCompactSpace.html" title="struct mmtk::policy::markcompactspace::MarkCompactSpace">MarkCompactSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-MallocSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/marksweepspace/malloc_ms/global.rs.html#143-244">source</a><a href="#impl-Space%3CVM%3E-for-MallocSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../marksweepspace/malloc_ms/global/struct.MallocSpace.html" title="struct mmtk::policy::marksweepspace::malloc_ms::global::MallocSpace">MallocSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-MarkSweepSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/marksweepspace/native_ms/global.rs.html#225-257">source</a><a href="#impl-Space%3CVM%3E-for-MarkSweepSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../marksweepspace/native_ms/global/struct.MarkSweepSpace.html" title="struct mmtk::policy::marksweepspace::native_ms::global::MarkSweepSpace">MarkSweepSpace</a>&lt;VM&gt;</h3></section><section id="impl-Space%3CVM%3E-for-VMSpace%3CVM%3E" class="impl"><a class="src rightside" href="../../../src/mmtk/policy/vmspace.rs.html#95-157">source</a><a href="#impl-Space%3CVM%3E-for-VMSpace%3CVM%3E" class="anchor">§</a><h3 class="code-header">impl&lt;VM: <a class="trait" href="../../vm/trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt; <a class="trait" href="trait.Space.html" title="trait mmtk::policy::space::Space">Space</a>&lt;VM&gt; for <a class="struct" href="../vmspace/struct.VMSpace.html" title="struct mmtk::policy::vmspace::VMSpace">VMSpace</a>&lt;VM&gt;</h3></section></div><script src="../../../trait.impl/mmtk/policy/space/trait.Space.js" async></script></section></div></main></body></html>
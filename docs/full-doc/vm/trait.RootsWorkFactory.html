<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Root-scanning methods use this trait to create work packets for processing roots."><meta name="keywords" content="rust, rustlang, rust-lang, RootsWorkFactory"><title>RootsWorkFactory in mmtk::vm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../../mmtk/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.png" alt="logo"></div>
        </a><h2 class="location">Trait RootsWorkFactory</h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><div class="sidebar-links"><a href="#tymethod.create_process_edge_roots_work">create_process_edge_roots_work</a><a href="#tymethod.create_process_node_roots_work">create_process_node_roots_work</a></div><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div><h2 class="location">Other items in<br><a href="../index.html">mmtk</a>::<wbr><a href="index.html">vm</a></h2><div id="sidebar-vars" data-name="RootsWorkFactory" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../mmtk/index.html"><img class="rust-logo" src="../../rust-logo.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><h1 class="fqn"><span class="in-band">Trait <a href="../index.html">mmtk</a>::<wbr><a href="index.html">vm</a>::<wbr><a class="trait" href="#">RootsWorkFactory</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/mmtk/vm/scanning.rs.html#51-72" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust trait"><code>pub trait RootsWorkFactory&lt;ES:&nbsp;<a class="trait" href="edge_shape/trait.Edge.html" title="trait mmtk::vm::edge_shape::Edge">Edge</a>&gt;: <a class="trait" href="https://doc.rust-lang.org/1.59.0/core/clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a> + <a class="trait" href="https://doc.rust-lang.org/1.59.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'static {
    fn <a href="#tymethod.create_process_edge_roots_work" class="fnname">create_process_edge_roots_work</a>(&amp;mut self, edges: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;ES&gt;);
<div class="item-spacer"></div>    fn <a href="#tymethod.create_process_node_roots_work" class="fnname">create_process_node_roots_work</a>(&amp;mut self, nodes: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>&gt;);
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Root-scanning methods use this trait to create work packets for processing roots.</p>
<p>Notes on the required traits:</p>
<ul>
<li>
<p><code>Clone</code>: The VM may divide one root-scanning call (such as <code>scan_vm_specific_roots</code>) into
multiple work packets to scan roots in parallel.  In this case, the factory shall be cloned
to be given to multiple work packets.</p>
<p>Cloning may be expensive if a factory contains many states. If the states are immutable, a
<code>RootsWorkFactory</code> implementation may hold those states in an <code>Arc</code> field so that multiple
factory instances can still share the part held in the <code>Arc</code> even after cloning.</p>
</li>
<li>
<p><code>Send</code> + ’static: The factory will be given to root-scanning work packets.
Because work packets are distributed to and executed on different GC workers,
it needs <code>Send</code> to be sent between threads.  <code>'static</code> means it must not have
references to variables with limited lifetime (such as local variables), because
it needs to be moved between threads.</p>
</li>
</ul>
</div></details><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.create_process_edge_roots_work" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/mmtk/vm/scanning.rs.html#58" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.create_process_edge_roots_work" class="fnname">create_process_edge_roots_work</a>(&amp;mut self, edges: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;ES&gt;)</h4></div></summary><div class="docblock"><p>Create work packets to handle root edges.</p>
<p>The work packet may update the edges.</p>
<p>Arguments:</p>
<ul>
<li><code>edges</code>: A vector of edges.</li>
</ul>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.create_process_node_roots_work" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/mmtk/vm/scanning.rs.html#71" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.create_process_node_roots_work" class="fnname">create_process_node_roots_work</a>(&amp;mut self, nodes: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../util/address/struct.ObjectReference.html" title="struct mmtk::util::address::ObjectReference">ObjectReference</a>&gt;)</h4></div></summary><div class="docblock"><p>Create work packets to handle nodes pointed by root edges.</p>
<p>The work packet cannot update root edges, therefore it cannot move the objects.  This
method can only be used by GC algorithms that never moves objects, or GC algorithms that
supports object pinning.</p>
<p>This method is useful for conservative stack scanning, or VMs that cannot update some
of the root edges.</p>
<p>Arguments:</p>
<ul>
<li><code>nodes</code>: A vector of references to objects pointed by root edges.</li>
</ul>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><div id="impl-RootsWorkFactory%3C%3C%3CE%20as%20ProcessEdgesWork%3E%3A%3AVM%20as%20VMBinding%3E%3A%3AVMEdge%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/mmtk/scheduler/gc_work.rs.html#548-572" title="goto source code">[src]</a></div><a href="#impl-RootsWorkFactory%3C%3C%3CE%20as%20ProcessEdgesWork%3E%3A%3AVM%20as%20VMBinding%3E%3A%3AVMEdge%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;E:&nbsp;<a class="trait" href="../scheduler/gc_work/trait.ProcessEdgesWork.html" title="trait mmtk::scheduler::gc_work::ProcessEdgesWork">ProcessEdgesWork</a>&gt; <a class="trait" href="scanning/trait.RootsWorkFactory.html" title="trait mmtk::vm::scanning::RootsWorkFactory">RootsWorkFactory</a>&lt;&lt;&lt;E as <a class="trait" href="../scheduler/gc_work/trait.ProcessEdgesWork.html" title="trait mmtk::scheduler::gc_work::ProcessEdgesWork">ProcessEdgesWork</a>&gt;::<a class="associatedtype" href="../scheduler/gc_work/trait.ProcessEdgesWork.html#associatedtype.VM" title="type mmtk::scheduler::gc_work::ProcessEdgesWork::VM">VM</a> as <a class="trait" href="trait.VMBinding.html" title="trait mmtk::vm::VMBinding">VMBinding</a>&gt;::<a class="associatedtype" href="trait.VMBinding.html#associatedtype.VMEdge" title="type mmtk::vm::VMBinding::VMEdge">VMEdge</a>&gt; for <a class="struct" href="../scheduler/gc_work/struct.ProcessEdgesWorkRootsWorkFactory.html" title="struct mmtk::scheduler::gc_work::ProcessEdgesWorkRootsWorkFactory">ProcessEdgesWorkRootsWorkFactory</a>&lt;E&gt;</h3></div></div><script type="text/javascript" src="../../implementors/mmtk/vm/trait.RootsWorkFactory.js" async></script></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="mmtk" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.59.0 (9d1b2106e 2022-02-23)" ></div>
</body></html>
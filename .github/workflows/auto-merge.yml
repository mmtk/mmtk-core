name: Auto Merge Binding PRs

# only trigger on pull request closed events
on:
  pull_request:
#   types: [closed]
    branches:
      - master

jobs:
  # Figure out binding PRs.
  binding-refs:
    # this job will only run if the PR has been merged
#   if: github.event.pull_request.merged == true
    uses: ./.github/workflows/pr-binding-refs.yml
    with:
      pull_request: ${{ github.event.pull_request.number }}

  check-merge-openjdk-pr:
    uses: ./.github/workflows/auto-merge-inner.yml
    needs: binding-refs
#   if: github.event.pull_request.merged == true
    with:
      repo: ${{ needs.binding-refs.outputs.openjdk_binding_repo }}
      ref: ${{ needs.binding-refs.outputs.openjdk_binding_ref }}
      core_commit: ${{ github.event.pull_request.merge_commit_sha }}
    secrets: inherit
